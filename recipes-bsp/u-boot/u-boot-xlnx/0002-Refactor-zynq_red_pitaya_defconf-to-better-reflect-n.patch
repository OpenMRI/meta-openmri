From 6501bab40c4acc381e23af34020ac5c510c989c6 Mon Sep 17 00:00:00 2001
From: Danny Park <danny.park@outlook.com>
Date: Sat, 27 Jul 2019 01:46:27 -0400
Subject: [PATCH 2/2] Refactor zynq_red_pitaya_defconf to better reflect new
 additions and similarities with zynq_zc702_defconf.

---
 configs/zynq_red_pitaya_defconfig | 51 ++++++++++++++++++-------------
 include/configs/zynq_red_pitaya.h |  2 ++
 2 files changed, 31 insertions(+), 22 deletions(-)

diff --git a/configs/zynq_red_pitaya_defconfig b/configs/zynq_red_pitaya_defconfig
index fdd515f301..7fd85e6e75 100644
--- a/configs/zynq_red_pitaya_defconfig
+++ b/configs/zynq_red_pitaya_defconfig
@@ -1,24 +1,42 @@
 CONFIG_ARM=y
+# based off zynq_zc702_defconfig
+# some options commented out
+# some options added
+# start red-pitaya unique options xilinx-v2019.1
 CONFIG_SYS_CONFIG_NAME="zynq_red_pitaya"
+CONFIG_SYS_MALLOC_F_LEN=0x800
+CONFIG_SYS_NO_FLASH=y
+CONFIG_BOOTCOMMAND="run $modeboot || run distro_bootcmd"
+CONFIG_CMD_DFU=y
+CONFIG_CMD_GPIO=y
+CONFIG_CMD_DHCP=y
+CONFIG_CMD_PING=y
+CONFIG_USB_STORAGE=y
+CONFIG_CMD_EXT4=y
+CONFIG_ENV_IS_IN_EEPROM=y
+CONFIG_CMD_EEPROM=y
+CONFIG_DM_MMC=y
+CONFIG_ZYNQ_SDHCI=y
+CONFIG_CMD_FAT=y
+CONFIG_CMD_FS_GENERIC=y
+CONFIG_OF_EMBED=y
+# end red-pitaya unique options
 CONFIG_ARCH_ZYNQ=y
 CONFIG_SYS_TEXT_BASE=0x4000000
 CONFIG_SPL=y
-CONFIG_SYS_MALLOC_F_LEN=0x800
 CONFIG_DEBUG_UART_BASE=0xe0001000
 CONFIG_DEBUG_UART_CLOCK=50000000
 CONFIG_IDENT_STRING=" Zynq Red Pitaya OpenMRI"
 CONFIG_SPL_STACK_R_ADDR=0x200000
-CONFIG_SYS_NO_FLASH=y
 #CONFIG_DEBUG_UART=y
 CONFIG_DISTRO_DEFAULTS=y
 #CONFIG_FIT=y
 #CONFIG_FIT_SIGNATURE=y
 #CONFIG_FIT_VERBOSE=y
 CONFIG_IMAGE_FORMAT_LEGACY=y
-CONFIG_BOOTCOMMAND="run $modeboot || run distro_bootcmd"
-# CONFIG_DISPLAY_CPUINFO is not set
 CONFIG_SPL_STACK_R=y
 CONFIG_SPL_OS_BOOT=y
+#CONFIG_SPL_SPI_LOAD=y
 CONFIG_SYS_PROMPT="Zynq> "
 #CONFIG_CMD_THOR_DOWNLOAD=y
 CONFIG_CMD_MEMTEST=y
@@ -33,23 +51,13 @@ CONFIG_CMD_I2C=y
 CONFIG_CMD_MMC=y
 CONFIG_CMD_SF=y
 CONFIG_CMD_USB=y
-CONFIG_CMD_DFU=y
-CONFIG_CMD_GPIO=y
 # CONFIG_CMD_SETEXPR is not set
-# CONFIG_CMD_TFTPPUT=y
-CONFIG_CMD_DHCP=y
-# CONFIG_CMD_MII=y
-CONFIG_CMD_PING=y
+#CONFIG_CMD_TFTPPUT=y
 CONFIG_CMD_CACHE=y
-# CONFIG_CMD_EXT2=y
-CONFIG_CMD_EXT4=y
 CONFIG_CMD_EXT4_WRITE=y
 CONFIG_DEFAULT_DEVICE_TREE="zynq-red-pitaya"
-CONFIG_CMD_FAT=y
-CONFIG_CMD_FS_GENERIC=y
-CONFIG_OF_EMBED=y
 CONFIG_ENV_IS_IN_SPI_FLASH=y
-# CONFIG_NET_RANDOM_ETHADDR=y
+#CONFIG_NET_RANDOM_ETHADDR=y
 CONFIG_SPL_DM_SEQ_ALIAS=y
 CONFIG_DFU_MMC=y
 CONFIG_DFU_RAM=y
@@ -58,12 +66,10 @@ CONFIG_FPGA_ZYNQPL=y
 CONFIG_DM_GPIO=y
 CONFIG_DM_I2C=y
 CONFIG_SYS_I2C_CADENCE=y
-CONFIG_DM_MMC=y
-CONFIG_ZYNQ_SDHCI=y
+#CONFIG_LED=y
+#CONFIG_LED_GPIO=y
 CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
-CONFIG_ENV_IS_IN_EEPROM=y
-CONFIG_CMD_EEPROM=y
 #CONFIG_SYS_I2C_EEPROM_ADDR=0x0
 #CONFIG_SYS_I2C_EEPROM_ADDR_OVERFLOW=0x0
 CONFIG_MMC_SDHCI=y
@@ -79,18 +85,19 @@ CONFIG_SPI_FLASH_WINBOND=y
 CONFIG_PHY_MARVELL=y
 CONFIG_PHY_REALTEK=y
 CONFIG_PHY_XILINX=y
+#CONFIG_MII=y
 CONFIG_ZYNQ_GEM=y
 CONFIG_DEBUG_UART_ZYNQ=y
 CONFIG_ZYNQ_SERIAL=y
-# CONFIG_ZYNQ_QSPI=y
+#CONFIG_ZYNQ_QSPI=y
 CONFIG_USB=y
 CONFIG_USB_EHCI_HCD=y
 CONFIG_USB_ULPI_VIEWPORT=y
 CONFIG_USB_ULPI=y
-CONFIG_USB_STORAGE=y
 CONFIG_USB_GADGET=y
 CONFIG_USB_GADGET_MANUFACTURER="Xilinx"
 CONFIG_USB_GADGET_VENDOR_NUM=0x03fd
 CONFIG_USB_GADGET_PRODUCT_NUM=0x0300
 CONFIG_CI_UDC=y
 CONFIG_USB_GADGET_DOWNLOAD=y
+#CONFIG_USB_FUNCTION_THOR=y
diff --git a/include/configs/zynq_red_pitaya.h b/include/configs/zynq_red_pitaya.h
index ad418cac65..3d0979fecd 100644
--- a/include/configs/zynq_red_pitaya.h
+++ b/include/configs/zynq_red_pitaya.h
@@ -1,6 +1,8 @@
 #ifndef __CONFIG_ZYNQ_RED_PITAYA_H
 #define __CONFIG_ZYNQ_RED_PITAYA_H
 
+/* originally based on zynq_zc70x.h with many additions. */
+
 #define CONFIG_ZYNQ_I2C0
 #define CONFIG_ZYNQ_EEPROM
 #define CONFIG_CMD_EEPROM
-- 
2.17.1

